nout = 50
timestep = 0.1


[mesh]

extrapolate_y = false 

[mesh:paralleltransform]
type = fci


[solver]
mxstep = 10000
rtol = 1e-5
atol = 1e-8
mms = true  # Run with MMS sources and output diagnostics
mms_initialise = true
[hermes]
components = h+


Nnorm = 1e18
Bnorm = 1
Tnorm = 5

[h+]  # Ions
type = evolve_density, evolve_pressure, anomalous_diffusion_3d
charge = 1.0
AA = 1.0

mms = true
diagnose = true
thermal_conduction = false

anomalous_D = 1.0 +  0.1*sin(2.0 * pi * x) * cos(2*z)
anomalous_chi = 1.0

[Nh+]

solution = 0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0

source = 1.03035789799417e-6*(0.019998292508765*sin(6.28318530717959*x)*cos(2.0*z) + 0.19998292508765)*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.64843189062429e-8*sin(6.28318530717959*x)^2*sin(2.0*z)*cos(2.0*z + 0.231) - 4.12107972656072e-9*sin(2.0*z + 0.231)*cos(6.28318530717959*x)^2*cos(2.0*z)

bndry_all = dirichlet_o2(`Nh+:solution`)

[Ph+]

solution = 0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0

source = -3.47990272666667e-8*(0.019998292508765*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 0.19998292508765)*(-7.89568352087149*sin(12.5663706143592*x)*sin(2.0*z + 0.5123)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0) + 3.94784176043574*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(6.28318530717959*x)*sin(2.0*z + 0.231)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0)^2 - 0.789568352087149*sin(2.0*z + 0.231)*sin(2.0*z + 0.5123)*cos(6.28318530717959*x)*cos(12.5663706143592*x)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0)^2 + 0.789568352087149*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(2.0*z + 0.231)^2*cos(6.28318530717959*x)^2/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0)^3) - 3.47990272666667e-8*(0.019998292508765*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 0.19998292508765)*(-7.89568352087149*sin(12.5663706143592*x)*sin(2.0*z + 0.5123)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0) + 15.791367041743*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(6.28318530717959*x)*sin(2.0*z + 0.231)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0)^2 - 1.5791367041743*sin(6.28318530717959*x)*sin(12.5663706143592*x)*cos(2.0*z + 0.231)*cos(2.0*z + 0.5123)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0)^2 + 3.15827340834859*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(6.28318530717959*x)^2*cos(2.0*z + 0.231)^2/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0)^3) - 8.74520279143913e-9*(0.628318530717959*sin(12.5663706143592*x)*cos(2.0*z + 0.5123)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0) - 1.25663706143592*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(6.28318530717959*x)*cos(2.0*z + 0.231)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0)^2)*sin(6.28318530717959*x)*cos(2.0*z + 0.231) - 4.37260139571957e-9*(0.628318530717959*sin(2.0*z + 0.5123)*cos(12.5663706143592*x)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0) - 0.628318530717959*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(2.0*z + 0.231)*cos(6.28318530717959*x)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0)^2)*sin(2.0*z + 0.231)*cos(6.28318530717959*x) + 1.03035789799417e-6*(0.019998292508765*sin(6.28318530717959*x)*cos(2.0*z) + 0.19998292508765)*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(6.28318530717959*x)*sin(2.0*z + 0.231)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0) - 4.12143159197666e-8*(0.019998292508765*sin(6.28318530717959*x)*cos(2.0*z) + 0.19998292508765)*sin(6.28318530717959*x)*sin(12.5663706143592*x)*cos(2.0*z + 0.231)*cos(2.0*z + 0.5123)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0) - 2.06071579598833e-8*(0.019998292508765*sin(6.28318530717959*x)*cos(2.0*z) + 0.19998292508765)*sin(2.0*z + 0.231)*sin(2.0*z + 0.5123)*cos(6.28318530717959*x)*cos(12.5663706143592*x)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0) + 1.64843189062429e-8*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(6.28318530717959*x)^2*sin(2.0*z)*cos(2.0*z + 0.231)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0) - 4.12107972656072e-9*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(2.0*z + 0.231)*cos(6.28318530717959*x)^2*cos(2.0*z)/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0) + 8.24286318395333e-8*(0.019998292508765*sin(6.28318530717959*x)*cos(2.0*z) + 0.19998292508765)*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(6.28318530717959*x)^2*cos(2.0*z + 0.231)^2/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0)^2 + 2.06071579598833e-8*(0.019998292508765*sin(6.28318530717959*x)*cos(2.0*z) + 0.19998292508765)*(0.05*sin(12.5663706143592*x)*sin(2.0*z + 0.5123) + 2.0)*sin(2.0*z + 0.231)^2*cos(6.28318530717959*x)^2/(0.1*sin(6.28318530717959*x)*sin(2.0*z + 0.231) + 1.0)^2


bndry_all = dirichlet_o2(`Ph+:solution`)
