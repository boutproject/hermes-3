nout = 50
timestep = 0.1


[mesh]
extrapolate_y = false 


[mesh:paralleltransform]
type = fci


[solver]
mxstep = 10000
rtol = 1e-5
atol = 1e-9
mms = true  # Run with MMS sources and output diagnostics
mms_initialise = true


[hermes]
components = h


Nnorm = 1e18
Bnorm = 1
Tnorm = 5

[h]
type = neutral_mixed

AA = 1.0

use_finite_difference = false
neutral_lmax = 0.02
evolve_momentum = true
isMMS = true
neutral_conduction = true
neutral_viscosity = true



[Nh]
solution = 0.02*sin(y + 0.3123) + 0.1

source = 2.2847e-5*(0.02*sin(y + 0.3123) + 0.1)*cos(y + 2.613) + 4.5694e-7*sin(y + 2.613)*cos(y + 0.3123)
bndry_all = neumann
bndry_par_all = parallel_dirichlet_o2(`Nh:solution`)
[NVh]
solution = 0.1*(0.02*sin(y + 0.3123) + 0.1)*sin(y + 2.613)

source = 4.5694e-6*(0.02*sin(y + 0.3123) + 0.1)*sin(y + 2.613)*cos(y + 2.613) + 0.000182776*(0.02*sin(y + 0.3123) + 0.1)*cos(2.0*y + 1.321) + 3.23105372595381e-7*(0.02*sin(y + 0.3123) + 0.1)*(0.4*sin(2.0*y + 1.321) + 2.0)*sin(y + 2.613)/sqrt(0.2*sin(2.0*y + 1.321) + 1) - 2.58484298076305e-7*(0.02*sin(y + 0.3123) + 0.1)*cos(y + 2.613)*cos(2.0*y + 1.321)/sqrt(0.2*sin(2.0*y + 1.321) + 1) + 6.46210745190762e-8*(0.02*sin(y + 0.3123) + 0.1)*(0.4*sin(2.0*y + 1.321) + 2.0)*cos(y + 2.613)*cos(2.0*y + 1.321)/(0.2*sin(2.0*y + 1.321) + 1)^(3/2) + 4.5694e-6*(0.4*sin(2.0*y + 1.321) + 2.0)*cos(y + 0.3123) + 4.5694e-8*sin(y + 2.613)^2*cos(y + 0.3123) - 6.46210745190762e-9*(0.4*sin(2.0*y + 1.321) + 2.0)*cos(y + 0.3123)*cos(y + 2.613)/sqrt(0.2*sin(2.0*y + 1.321) + 1)
bndry_all = neumann
bndry_par_all = parallel_dirichlet_o2(`NVh:solution`)
[Ph]
solution = (0.02*sin(y + 0.3123) + 0.1)*(0.4*sin(2.0*y + 1.321) + 2.0)

source = 1.52313333333333e-5*(0.8*(0.02*sin(y + 0.3123) + 0.1)*cos(2.0*y + 1.321) + 0.02*(0.4*sin(2.0*y + 1.321) + 2.0)*cos(y + 0.3123))*sin(y + 2.613) + 3.80783333333333e-5*(0.02*sin(y + 0.3123) + 0.1)*(0.4*sin(2.0*y + 1.321) + 2.0)*cos(y + 2.613) + 3.04626666666667e-5*(0.02*sin(y + 0.3123) + 0.1)*sin(y + 2.613)*cos(2.0*y + 1.321) + 8.61614326921016e-6*(0.02*sin(y + 0.3123) + 0.1)*(0.4*sin(2.0*y + 1.321) + 2.0)*sin(2.0*y + 1.321)/sqrt(0.2*sin(2.0*y + 1.321) + 1) - 3.44645730768406e-6*(0.02*sin(y + 0.3123) + 0.1)*cos(2.0*y + 1.321)^2/sqrt(0.2*sin(2.0*y + 1.321) + 1) + 8.61614326921016e-7*(0.02*sin(y + 0.3123) + 0.1)*(0.4*sin(2.0*y + 1.321) + 2.0)*cos(2.0*y + 1.321)^2/(0.2*sin(2.0*y + 1.321) + 1)^(3/2) + 7.61566666666667e-7*(0.4*sin(2.0*y + 1.321) + 2.0)*sin(y + 2.613)*cos(y + 0.3123) + 0.0666666666666667*(-3.23105372595381e-7*(0.02*sin(y + 0.3123) + 0.1)*(0.4*sin(2.0*y + 1.321) + 2.0)*sin(y + 2.613)/sqrt(0.2*sin(2.0*y + 1.321) + 1) + 2.58484298076305e-7*(0.02*sin(y + 0.3123) + 0.1)*cos(y + 2.613)*cos(2.0*y + 1.321)/sqrt(0.2*sin(2.0*y + 1.321) + 1) - 6.46210745190762e-8*(0.02*sin(y + 0.3123) + 0.1)*(0.4*sin(2.0*y + 1.321) + 2.0)*cos(y + 2.613)*cos(2.0*y + 1.321)/(0.2*sin(2.0*y + 1.321) + 1)^(3/2) + 6.46210745190762e-9*(0.4*sin(2.0*y + 1.321) + 2.0)*cos(y + 0.3123)*cos(y + 2.613)/sqrt(0.2*sin(2.0*y + 1.321) + 1))*sin(y + 2.613) - 8.61614326921016e-8*(0.4*sin(2.0*y + 1.321) + 2.0)*cos(y + 0.3123)*cos(2.0*y + 1.321)/sqrt(0.2*sin(2.0*y + 1.321) + 1)
bndry_all = neumann
bndry_par_all = parallel_dirichlet_o2(`Ph:solution`)