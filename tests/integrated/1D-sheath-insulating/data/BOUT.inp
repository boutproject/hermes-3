# 1D system with:
#  - no-flow boundary on lower Y
#  - sheath boundary on upper Y
#  - Evolving electron and ion species
#  - No heat conduction
#  - Uniform source of heat and particles throughout domain

nout = 1
timestep = 10

MXG = 0  # No guard cells in X

# Ensures sheath and noflow boundaries are at opposite ends
lower_sheath = false
upper_sheath = !lower_sheath

[mesh]
nx = 1
ny = 8   # Resolution along field-line
nz = 1

length = 1            # Length of the domain in meters
length_xpt = length   # Length from midplane to X-point [m]

dy = length / ny

ypos = y * length / (2*pi) # Y position [m]

ixseps1 = -1
ixseps2 = -1

J = 1 # Identity metric

[hermes]
# Evolve ion density, ion and electron pressure
components = i, e, sheath_boundary_insulating

normalise_metric = true

Nnorm = 1e19
Bnorm = 1
Tnorm = 100

[solver]
mxstep = 10000

[sheath_boundary_insulating]

lower_y = lower_sheath
upper_y = upper_sheath

####################################

[i]  # Ions
type = evolve_density, evolve_pressure, evolve_momentum, noflow_boundary

noflow_lower_y = !lower_sheath
noflow_upper_y = !upper_sheath

charge = 1
AA = 1.0

thermal_conduction = false  # in evolve_pressure

diagnose = true

[Ni]

function = 1

flux = 4e23  # Particles per m^2 per second input
source = (flux/(mesh:length_xpt))*H(mesh:length_xpt - mesh:ypos)

[Pi]
function = 1

powerflux = 2e7  # Input power flux in W/m^2

source = (powerflux*2/3 / (mesh:length_xpt))*H(mesh:length_xpt - mesh:ypos)  # Input power as function of y

[NVi]

function = 0

####################################

[e] # Electrons
type = quasineutral, evolve_pressure, zero_current, noflow_boundary

noflow_lower_y = !lower_sheath
noflow_upper_y = !upper_sheath

charge = -1
AA = 1/1836

thermal_conduction = false  # in evolve_pressure

[Pe]

function = Pi:function  # Same as ion pressure initially

source = Pi:source  # Same as ion pressure source
