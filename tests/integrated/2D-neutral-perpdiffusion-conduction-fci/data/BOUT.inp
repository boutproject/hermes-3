nout = 50
timestep = 0.1


[mesh]

extrapolate_y = false 

[mesh:paralleltransform]
type = fci


[solver]
mxstep = 10000
rtol = 1e-5
atol = 1e-9
mms = true  # Run with MMS sources and output diagnostics
mms_initialise = true
[hermes]
components = h


Nnorm = 1e18
Bnorm = 1
Tnorm = 5

[h]
type = neutral_mixed

AA = 1.0

use_finite_difference = true
neutral_lmax = 0.02
evolve_momentum = false
isMMS = true
neutral_conduction = true

[Nh]

solution = 0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1

source = -3.23105372595381e-6*(-3.15827340834859*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) - 63.1654681669719*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.52661872667888*sin(6.28318530717959*x)*sin(12.5663706143592*x)*cos(2.0*z - 0.315312)*cos(2.0*z + 1.33221))/sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1) - 3.23105372595381e-6*(-3.15827340834859*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) - 15.791367041743*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1.26330936333944*sin(2.0*z - 0.315312)*sin(2.0*z + 1.33221)*cos(6.28318530717959*x)*cos(12.5663706143592*x))/sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1) + 4.06026185952417e-6*(0.251327412287183*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(12.5663706143592*x)*cos(2.0*z + 1.33221) + 5.02654824574367*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(6.28318530717959*x)*cos(2.0*z - 0.315312))*sin(6.28318530717959*x)*cos(2.0*z - 0.315312)/(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1)^(3/2) + 2.03013092976208e-6*(0.251327412287183*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(2.0*z + 1.33221)*cos(12.5663706143592*x) + 2.51327412287183*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(2.0*z - 0.315312)*cos(6.28318530717959*x))*sin(2.0*z - 0.315312)*cos(6.28318530717959*x)/(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1)^(3/2)


bndry_all = dirichlet_o2(`Nh:solution`)


[Ph]

solution = (0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)

source = -2.15403581730254e-5*(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1)^(3/2)*(-3.15827340834859*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) - 63.1654681669719*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.52661872667888*sin(6.28318530717959*x)*sin(12.5663706143592*x)*cos(2.0*z - 0.315312)*cos(2.0*z + 1.33221))/(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0) - 2.15403581730254e-5*(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1)^(3/2)*(-3.15827340834859*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) - 15.791367041743*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1.26330936333944*sin(2.0*z - 0.315312)*sin(2.0*z + 1.33221)*cos(6.28318530717959*x)*cos(12.5663706143592*x))/(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0) - 8.12052371904834e-5*sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1)*(0.251327412287183*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(12.5663706143592*x)*cos(2.0*z + 1.33221) + 5.02654824574367*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(6.28318530717959*x)*cos(2.0*z - 0.315312))*sin(6.28318530717959*x)*cos(2.0*z - 0.315312)/(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0) - 4.06026185952417e-5*sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1)*(0.251327412287183*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(2.0*z + 1.33221)*cos(12.5663706143592*x) + 2.51327412287183*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(2.0*z - 0.315312)*cos(6.28318530717959*x))*sin(2.0*z - 0.315312)*cos(6.28318530717959*x)/(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0) + 0.000425189627651065*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(6.28318530717959*x)*sin(2.0*z - 0.315312)/sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1) - 6.80303404241704e-6*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(6.28318530717959*x)*sin(12.5663706143592*x)*cos(2.0*z - 0.315312)*cos(2.0*z + 1.33221)/sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1) - 3.40151702120852e-6*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(2.0*z - 0.315312)*sin(2.0*z + 1.33221)*cos(6.28318530717959*x)*cos(12.5663706143592*x)/sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1) - 0.000136060680848341*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(6.28318530717959*x)^2*cos(2.0*z - 0.315312)^2/sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1) - 3.40151702120852e-5*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(2.0*z - 0.315312)^2*cos(6.28318530717959*x)^2/sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1) + 2.70684123968278e-5*(0.251327412287183*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(12.5663706143592*x)*cos(2.0*z + 1.33221) + 5.02654824574367*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(6.28318530717959*x)*cos(2.0*z - 0.315312))*sin(6.28318530717959*x)*cos(2.0*z - 0.315312)/sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1) + 1.35342061984139e-5*(0.251327412287183*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*sin(2.0*z + 1.33221)*cos(12.5663706143592*x) + 2.51327412287183*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(2.0*z - 0.315312)*cos(6.28318530717959*x))*sin(2.0*z - 0.315312)*cos(6.28318530717959*x)/sqrt(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1) + 3.40151702120852e-5*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(6.28318530717959*x)^2*cos(2.0*z - 0.315312)^2/(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1)^(3/2) + 8.5037925530213e-6*(0.4*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 2.0)*(0.02*sin(12.5663706143592*x)*sin(2.0*z + 1.33221) + 0.1)*sin(2.0*z - 0.315312)^2*cos(6.28318530717959*x)^2/(0.2*sin(6.28318530717959*x)*sin(2.0*z - 0.315312) + 1)^(3/2)

bndry_all = dirichlet_o2(`Ph:solution`)
