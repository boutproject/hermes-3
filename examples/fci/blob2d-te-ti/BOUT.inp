nout = 100
timestep = 200

[mesh]

#file = "SlabBloblinear_260_2_256_1.0_1.5_0.35.fci.grid.nc"
file = "SlabBlob_260_2_256_1.0_1.5_0.0.fci.grid.nc"

[mesh:paralleltransform]
type = fci

[solver]
mxstep = 10000
type = cvode
rtol = 1e-5
atol = 1e-10
[hermes]
# Two species, electrons and ions
components = e, h+, vorticity, sheath_closure


Nnorm = 2e18
Bnorm = 1.0
Tnorm = 5

[e]
type = evolve_density, evolve_pressure

charge = -1
AA = 1/1836

poloidal_flows = false  # Y flows due to ExB
thermal_conduction = false  # Parallel heat conduction

[Ne]
height = 0.5
width = 0.05

function = 1 + height * exp(-((x-0.25)/width)^2 - ((z/(2*pi) - 0.5)/width)^2)

bndry_all = neumann

[Pe]
function = Ne:function
bndry_all = neumann

[h+]
# Set the density so that the plasma is quasineutral
type = quasineutral, evolve_pressure

charge = 1
AA = 1

bndry_flux = true
poloidal_flows = false
thermal_conduction = false

[Nh+]
function = Ne:function

[Ph+]
function = `Nh+:function`
bndry_all = neumann

[vorticity]

diamagnetic = true   # Include diamagnetic current?
diamagnetic_polarisation = true # Include diamagnetic drift in polarisation current?
average_atomic_mass = 1.0   # Weighted average atomic mass, for polarisaion current
bndry_flux = false # Allow flows through radial boundaries
poloidal_flows = false  # Include poloidal ExB flow
split_n0 = false  # Split phi into n=0 and n!=0 components
phi_dissipation = false


[vorticity:laplacian]

type   = petsc  # Needed if Boussinesq = false
ksptype = gmres # Linear iterative method

inner_boundary_flags = 16
outer_boundary_flags = 16



[sheath_closure]
connection_length = 10 # meters
potential_offset = 0.0  # Potential at which sheath current is zero
