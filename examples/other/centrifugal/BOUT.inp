nout = 100
timestep = 1000

MYG = 0 # No guard cells in Y

[mesh]

nx = 36   # Radial resolution including 4 guard cells
ny = 1    # Parallel direction
nz = 64   # number of points in azimuthal direction

Rmin = 0.1  # minimum radius in meters
Rmax = 0.4  # maximum radius in meters

Bxy = 0.1   # Magnetic field strength [T]

# The following choices make a Clebsch coordinate system where
# x is a radial flux coordinate
# y is a parallel angle coordinate (0 -> 2π)
# z is azimuthal angle (0 -> 2π)
#
# Note: In input expressions,
#       x is normalised from 0->1, y and z from 0->2π,

Bpxy = Bxy
Btxy = 0
hthe = 1
Rxy = Rmin + (Rmax - Rmin) * x   # Radius from axis. Note: Here x is from 0->1
sinty = 0  # Integrated shear

dr = (Rmax - Rmin) / (nx - 4)
dx = Bpxy * Rxy * dr    # Radial flux coordinate
dy = 2π / ny     # Angle 0 -> 2π
dz = 2π / nz     # Azimuthal angle

ixseps1 = -1  # This line and the one below will add y boundaries
ixseps2 = -1  #

[solver]

mxstep = 10000

[hermes]
components = (e, d+,
              sound_speed,
              centrifugal_drift,
              vorticity)

Nnorm = 1e18  # Reference density [m^-3]
Bnorm = 1   # Reference magnetic field [T]
Tnorm = 1   # Reference temperature [eV]

recalculate_metric = true  # Recalculate metric tensor? (false -> use grid values)

[centrifugal_drift]

Ω = 1e5  # Rotation frequency [rad s^-1]
acceleration = Ω^2 * mesh:Rxy

[vorticity]
diamagnetic = false   # Include diamagnetic current?
diamagnetic_polarisation = true # Include diamagnetic drift in polarisation current?
average_atomic_mass = `d+`:AA   # Weighted average atomic mass, for polarisaion current
poloidal_flows = false  # Include poloidal ExB flow
split_n0 = false  # Split phi into n=0 and n!=0 components

vort_dissipation = false
phi_dissipation = false

phi_boundary_relax = false

[vorticity:laplacian]
inner_boundary_flags = 1 # Neumann
outer_boundary_flags = 0 # Dirichlet

################################################################
# Electrons
[e]
type = evolve_density, isothermal

AA = 1 / 1836
charge = -1

temperature = 5 # Electron temperature in eV

[Ne]
bndry_all = neumann

function = 1e-1 * exp(-x^2) + 1e-5*(mixmode(z) + mixmode(4*z - x)) # Starting density profile [x10^18 m^-3]

################################################################
# Deuterium ions
[d+]
type = quasineutral, isothermal

AA = 2       # Atomic mass
charge = 1

temperature = 0.1   # Ion temperature in eV

